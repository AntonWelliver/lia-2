<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset="UTF-8" />

	<title>Salus mea - Larmportal</title>

	<link rel="stylesheet" type="text/css" href="css/index_main3.css" />
	<link href="css/loginbox.css" rel="stylesheet" type="text/css" />
       <link rel="icon" href="/alertyFavicon.png" type="image/png">
       <link rel="shortcut icon" href="/alertyFavicon.png" type="image/png">
	<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
	<script type="text/javascript" src="js/alerty.js"></script>
	<script type="text/javascript" src="js/overlay.js"></script>
	<script type="text/javascript">
	function doFilter() {
		var text = $('#filter').val().toUpperCase();
		$("form").hide();
		var wlanbssids = $( "input[name*='wlanbssid']" );
		wlanbssids.each(function(index) {
			if ($(this).val().toUpperCase().includes(text)) {
				$(this).parents("form").show();				
			}
		});
		var wlannames = $( "input[name*='wlanname']" );
		wlannames.each(function(index) {
			if ($(this).val().toUpperCase().includes(text)) {
				$(this).parents("form").show();				
			}
		});
		var wlaninfos = $( "input[name*='wlaninfo']" );
		wlaninfos.each(function(index) {
			if ($(this).val().toUpperCase().includes(text)) {
				$(this).parents("form").show();				
			}
		});
	}
	$.getJSON("/proximi_departments", function(result) {
		console.log(result);
		var options = $(".department");
		options.append(new Option('none', ''));
		$.each(result, function() {
			options.append(new Option(this.place_name + "/" + this.floor_name + "/" + this.name, this.id));
		});
		$.each(options, function() {
			$(this).val(this.title);
			this.title = '';
		});
	});
	function departmentChanged(id) {
		var department = document.getElementById('department' + id).value;
		if (department != null && department != "") {
			$.getJSON("/getAddressForDepartment.php?id=" + department, function(result) {
				document.getElementById('wlanname'+id).value = result.description;
				document.getElementById('wlaninfo'+id).value = result.address;
				document.getElementById("floor" + id).value = result.floor_id;
			});
			document.getElementById('wlanname'+id).readOnly = true;
		} else {
			document.getElementById('wlanname'+id).readOnly = false;
		}
	}
	function showMap(id) {
		var address = document.getElementById('wlaninfo' + id).value;
		wlanSelect(id, address);
	}
	</script>
</head>

<body onload="checkAlertNew();checkStatusesNew();">
	<audio id="alertsound">
		<source src="alert.wav" type="audio/wav" />
	</audio>
	<div id="sound_element"></div>
	<div id="video" class="Popdiv"> 
		<div class="Fader"></div>
		<div class="Overlay">
			<div class="Container" style="width:310px;height:250px">
				<a href="javascript:toggleVisible('video');" class="Close"></a>
				<div class="Content" id="videocontent">
					<iframe id="videoframe" src="" width="265" height="200"> </iframe>
				</div>
			</div>
		</div>
	</div>
	<div id="wlanmap" class="Popdiv"> 
		<div class="Fader"></div>
		<div class="Overlay">
			<div class="Container" style="width:800px;height:600px;background-color:#fff;margin-left:-350px;margin-top:-300px">
				<a href="javascript:toggleVisible('wlanmap');" class="Close"></a>
				<div class="Content">
					<div id="statusdata"><div id="statusdataheader"></div></div>
					<div class="mapClass" id="wmap" style="left:0;top:85px;right:0px">
					</div>
					<div style="position: absolute; top: 291px; left: 335px; z-index: 99">
						<img src="images/crosshair.png">
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="wrapper">
		<!-- Header -->
        <div id="header"><img id="logo" src="brand/salusmea-logo3.png" class="left">
			<div id="menu" class="">
				<ul>
					<li class="toolTip"><a href="alarm.html" class="imageLink"><img src="images/portalHeader/alerts.png"/><span class="toolTipText">Hantering av larm</span><p>Larm</p></a></li>
					<li class="toolTip"><a href="user.html" class="imageLink"><img src="images/portalHeader/users.png"/><span class="toolTipText">All användarinformation</span><p>Användare</p></a></li>
					<li class="toolTip"><a href="contact.html" class="imageLink"><img src="images/portalHeader/contacts.png"/><span class="toolTipText">Spara och radera användare</span><p>Kontakter</p></a></li>
					<li class="toolTip"><a href="wlan.html" class="imageLink"><img src="images/portalHeader/places.png" /><span class="toolTipText">Hantering av positionering</span><p>Platser</p></a></li>
					<li class="toolTip"><a href="archive.html" class="imageLink"><img src="images/portalHeader/archive.png" /><span class="toolTipText">Arkiv över alla larm</span><p>Arkiv</p></a></li>
					<li class="toolTip"><a href="index.html" class="imageLink"><img src="images/portalHeader/map.png"/><span class="toolTipText">Hantering av trygghetszonerna</span><p>Trygghetszoner</p></a></li>
					<li class="toolTip"><a href="manual.html" class="imageLink"><img src="images/portalHeader/help.png"/><span class="toolTipText">Information och support för sidan</span><p>Guide</p></a></li>
					<li><a href='login.html' class='imageLink'><img src='images/portalHeader/signout.png'/><p>Logga ut</p></a></li>
				</ul>	
			</div>
			<input id="filterWlan" onkeyup="doFilter()" placeholder="Sök..." maxlength="20" type="text">
		</div>

		<!-- Map -->
        <div id="mapContainer">
			<div id="satusdata">
				<div id="statusdataheader">
					<p class="left">Platser</p>
				</div>

				<div id="datadiv" class="dSettings">
					<div class='userinfo'>
						<form id='setWlanListForm1151' action='' method='post'>
							<table style='margin-left: auto; margin-right: auto; padding-top:16px; width: 82%;'>
								<tr>
									<td rowspan='5' class='rownum'>1</td>
									<td class='rowhdr'>BSSID</td>
									<td class='rowinfo'>
										<input name='wlanbssid' type='text' placeholder='00:1a:00:a1:b1:00' value='70:73:cb:bc:53:c0' id='wlanbssid1151'>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:showMap(1151)'>
												<img src='images/mapW.png' alt='show map'/>
											</a>
										</div>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:submitform(document.getElementById("setWlanListForm1151"))'>
												<img src='images/save.png' alt='save'/>
											</a>
										</div>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:deleteWlan(1151);'>
												<img src='images/delete.png' alt='save icon'/>
											</a>
										</div>
									</td>
								</tr>
								<tr>
									<td class='rowhdr'>Beskrivning</td>
									<td class='rowinfo'>
										<input name='wlanname' type='text' placeholder='Kontoret' value='Framtidens företag/Vån 2/Johanneberg' id='wlanname1151' maxlength='60' readonly>
									</td>
								</tr>
								<tr style='height: 40px;'>
									<td class='rowhdr'>Våningsplan</td>
									<td class='rowinfo'>
										<select name='department' id='department1151' class='department' style="border-radius: 15px;" title='67b8c02e-578f-41aa-b836-a67899a0b93b' onchange='departmentChanged(1151);'>
											<option value="0" selected disabled></option>
											<option value="1">1</option>
											<option value='2'>2</option>
											<option value='3'>3</option>
										</select>
									</td>
								</tr>
								<input type='hidden' name='id' value='1151'/>
								<input type='hidden' name='action' id='action1151' value='savewlan'/>
								<input type='hidden' name='floor' id='floor1151' value='14'/>
								<tr>
									<td class='rowhdr'>Adress</td>
									<td class='rowinfo'>
										<input name='wlaninfo' type='text' id='wlaninfo1151' placeholder='Vägen 1, Stad' value='Vera Sandbergs Allé 5B' readonly>
									</td>
								</tr>
							</table>
						</form>
					</div>
					<div class='userinfo'>
						<form id='setWlanListForm1151' action='' method='post'>
							<table style='margin-left: auto; margin-right: auto; padding-top:16px; width: 82%;'>
								<tr>
									<td rowspan='5' class='rownum'>2</td>
									<td class='rowhdr'>BSSID</td>
									<td class='rowinfo'>
										<input name='wlanbssid' type='text' placeholder='00:1a:00:a1:b1:00' value='70:73:cb:bc:53:c0' id='wlanbssid1151'>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:showMap(1151)'>
												<img src='images/mapW.png' alt='show map'/>
											</a>
										</div>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:submitform(document.getElementById("setWlanListForm1151"))'>
												<img src='images/save.png' alt='save'/>
											</a>
										</div>
									</td>
									<td rowspan='5' class='rowbtn'>
										<div class='savebtn2'>
											<a href='javascript:deleteWlan(1151);'>
												<img src='images/delete.png' alt='save icon'/>
											</a>
										</div>
									</td>
								</tr>
								<tr>
									<td class='rowhdr'>Beskrivning</td>
									<td class='rowinfo'>
										<input name='wlanname' type='text' placeholder='Kontoret' value='Framtidens företag/Vån 2/Johanneberg' id='wlanname1151' maxlength='60' readonly>
									</td>
								</tr>
								<tr style='height:40px;'>
									<td class='rowhdr'>Våningsplan</td>
									<td class='rowinfo'>
										<select name='department' id='department1151' class='department' style="border-radius: 15px;" title='67b8c02e-578f-41aa-b836-a67899a0b93b' onchange='departmentChanged(1151);'>
											<option value="0" selected disabled></option>
											<option value="1">1</option>
											<option value='2'>2</option>
											<option value='3'>3</option>
										</select>
									</td>
								</tr>
								<input type='hidden' name='id' value='1151'/>
								<input type='hidden' name='action' id='action1151' value='savewlan'/>
								<input type='hidden' name='floor' id='floor1151' value='14'/>
								<tr>
									<td class='rowhdr'>Adress</td>
									<td class='rowinfo'>
										<input name='wlaninfo' type='text' id='wlaninfo1151' placeholder='Vägen 1, Stad' value='Vera Sandbergs Allé 5B' readonly>
									</td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

    </div>
</body>
</html>